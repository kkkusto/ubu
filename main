import datetime

def get_min_max_partitions(schema_lines):    
    # max_yr should be greater than 7 years from the current year
    current_year = datetime.datetime.now().year
    threshold_yrs = 8
    min_yr = 9999999
    max_yr = current_year - threshold_yrs
    is_fill_enter_mnth = False
    null_partition = False
    max_fill_enter_mnth = int(str(current_year - threshold_yrs) + "12")
    print(max_fill_enter_mnth)
    max_fill_sold_yr = current_year - threshold_yrs
    for schema in schema_lines:
        partition = schema.replace("|", "").strip()

        partitions_dict = dict(item.split("=") for item in partition.split("/"))

        # check if partition contains only fill_sold_yr or fill_sold_yr and fill_sold_month
        
        fill_sold_yr = int(partitions_dict.get("fill_sold_yr") )

        if partitions_dict.get("fill_enter_mnth"):
            is_fill_enter_mnth = True
            fill_enter_mnth = int(partitions_dict.get("fill_enter_mnth"))
            #print("fill_enter_mnth_list: ", fill_enter_mnth_list)
            if fill_enter_mnth > max_fill_enter_mnth:
                continue
            min_yr =  min(fill_enter_mnth, min_yr)
            max_yr = max(fill_enter_mnth, max_yr)


        else:
            
            if fill_sold_yr == 1970:
                null_partition = True
            if fill_sold_yr > max_fill_sold_yr:
                continue
            min_yr =  min(fill_sold_yr, min_yr)
            max_yr = max(fill_sold_yr, max_yr)

    print("min_yr: ", min_yr)
    print("max_yr: ", max_yr)
    return min_yr, max_yr, is_fill_enter_mnth, null_partition
