
def format_rows_count_total(table_name, min_yr, max_yr, fill_sold_yr_present, fill_enter_mnth_present, rx_create_yr_present, rx_create_mnth_present):
    # if is_fill_enter_mnth:
    #     query = "select count(*) from {} where fill_enter_mnth>={} and fill_enter_mnth<={}".format(table_name, min_yr, max_yr)
    # else:
    #     query = "select count(*) from {} where fill_sold_yr>={} and fill_sold_yr<={}".format(table_name, min_yr, max_yr)
    # return query
    if fill_sold_yr_present:
        if fill_enter_mnth_present:
            query = "SELECT COUNT(*) FROM {} WHERE fill_enter_mnth>={} AND fill_enter_mnth<={}".format(table_name, min_yr, max_yr)
        else:
            query = "SELECT COUNT(*) FROM {} WHERE fill_sold_yr>={} AND fill_sold_yr<={}".format(table_name, min_yr, max_yr)
    elif rx_create_yr_present:
        if rx_create_mnth_present:
            query = "SELECT COUNT(*) FROM {} WHERE rx_create_mnth>={} AND rx_create_mnth<={}".format(table_name, min_yr, max_yr)
        else:
            query = "SELECT COUNT(*) FROM {} WHERE rx_create_yr>={} AND rx_create_yr<={}".format(table_name, min_yr, max_yr)
    return query


def format_insert_to_part2_table_query(table_name_part1, table_name_part2, min_yr, max_yr, fill_sold_yr_present, fill_enter_mnth_present, rx_create_yr_present, rx_create_mnth_present):
    if fill_sold_yr_present:
        if fill_enter_mnth_present:
            query = "INSERT INTO {} PARTITION (fill_sold_yr, fill_enter_mnth) SELECT * FROM {} WHERE fill_enter_mnth>={} AND fill_enter_mnth<={}".format(table_name_part2, table_name_part1, min_yr, max_yr)
        else:
            query = "INSERT INTO {} PARTITION (fill_sold_yr) SELECT * FROM {} WHERE fill_sold_yr>={} AND fill_sold_yr<={}".format(table_name_part2, table_name_part1, min_yr, max_yr)
    elif rx_create_yr_present:
        if rx_create_mnth_present:
            query = "INSERT INTO {} PARTITION (rx_create_yr, rx_create_mnth) SELECT * FROM {} WHERE rx_create_mnth>={} AND rx_create_mnth<={}".format(table_name_part2, table_name_part1, min_yr, max_yr)
        else:
            query = "INSERT INTO {} PARTITION (rx_create_yr) SELECT * FROM {} WHERE rx_create_yr>={} AND rx_create_yr<={}".format(table_name_part2, table_name_part1, min_yr, max_yr)
    return query

def delete_partition_query(table_name, min_yr, max_yr, fill_sold_yr_present, fill_enter_mnth_present, rx_create_yr_present, rx_create_mnth_present):
    if fill_sold_yr_present:
        if fill_enter_mnth_present:
            query = "ALTER TABLE {} DROP IF EXISTS PARTITION (fill_enter_mnth>={} AND fill_enter_mnth<={})".format(table_name, min_yr, max_yr)
        else:
            query = "ALTER TABLE {} DROP IF EXISTS PARTITION (fill_sold_yr>={} AND fill_sold_yr<={})".format(table_name, min_yr, max_yr)
    elif rx_create_yr_present:
        if rx_create_mnth_present:
            query = "ALTER TABLE {} DROP IF EXISTS PARTITION (rx_create_mnth>={} AND rx_create_mnth<={})".format(table_name, min_yr, max_yr)
        else:
            query = "ALTER TABLE {} DROP IF EXISTS PARTITION (rx_create_yr>={} AND rx_create_yr<={})".format(table_name, min_yr, max_yr)
    return query
